(function(){const qs=(s,r=document)=>r.querySelector(s);const out=(m)=>{const b=document.getElementById("resultBox")||document.querySelector("pre");if(b)b.textContent=typeof m==="string"?m:JSON.stringify(m,null,2)};async function loadUsers(){const box=qs("#adminUsersList");if(!box)return;box.textContent="Laden...";try{const r=await fetch("/api/admin/users",{headers:{"Accept":"application/json"}});if(!r.ok)throw new Error("HTTP "+r.status);const d=await r.json();if(Array.isArray(d.users)&&d.users.length){box.innerHTML="";const ul=document.createElement("ul");d.users.forEach(u=>{const li=document.createElement("li");li.textContent=`${u.name} â€“ ${u.email} (${u.role})`;ul.appendChild(li)});box.appendChild(ul)}else{box.innerHTML="<div class='muted'>Geen gebruikers gevonden.</div>"}}catch(err){box.innerHTML="<div class='error'>Fout bij laden</div>";out({ok:false,error:String(err)})}}async function addUser(ev){ev.preventDefault();const f=ev.target;const p={name:f.name.value.trim(),email:f.email.value.trim(),password:f.password.value,role:f.role.value};try{const r=await fetch("/api/admin/users",{method:"POST",headers:{"Content-Type":"application/json","Accept":"application/json"},body:JSON.stringify(p)});const d=await r.json();out(d);if(d.ok){f.reset();loadUsers()}}catch(err){out({ok:false,error:String(err)})}}function init(){const f=qs("#addAdminUserForm");if(f)f.addEventListener("submit",addUser);loadUsers()}if(document.readyState==="loading")document.addEventListener("DOMContentLoaded",init);else init();})();