
function iconBtns(key,id){return `<div class="actions"><button class="iconbtn" data-act="save" data-key="${key}" data-id="${id}">💾</button><button class="iconbtn" data-act="del" data-key="${key}" data-id="${id}">🗑️</button></div>`}
function input(name,val,type='text'){ return `<input name="${name}" type="${type}" value="${val??''}">`; }
function rowNamen(n){ return `<tr data-id="${n.id}"><td>${input('naam',n.naam)}</td><td>${input('prijs',n.prijs)}</td><td>${input('strippen',n.strippen)}</td><td>${input('max',n.max)}</td><td>${input('lesduur',n.lesduur)}</td><td>${input('mailblue',n.mailblue)}</td><td>${input('geldigheid',n.geldigheid)}</td><td class="actions-cell">${iconBtns('namen',n.id)}</td></tr>`; }
function rowTypes(t){ return `<tr data-id="${t.id}"><td>${input('type',t.type)}</td><td>${input('beschrijving',t.beschrijving||'')}</td><td class="actions-cell">${iconBtns('types',t.id)}</td></tr>`; }
function rowLoc(l){ const addr=`${l.adres||''}, ${l.plaats||''}, ${l.land||'BE'}`; const maps='https://www.google.com/maps/search/?api=1&query='+encodeURIComponent(addr); const disabled=(!l.adres||!l.plaats)?'disabled':''; return `<tr data-id="${l.id}"><td>${input('naam',l.naam)}</td><td>${input('adres',l.adres)}</td><td>${input('plaats',l.plaats)}</td><td>${input('land',l.land||'BE')}</td><td><a class="btn muted" href="${maps}" target="_blank" ${disabled}>Maps</a></td><td class="actions-cell">${iconBtns('locaties',l.id)}</td></tr>`; }
function rowThema(t){ return `<tr data-id="${t.id}"><td>${input('naam',t.naam)}</td><td class="actions-cell">${iconBtns('themas',t.id)}</td></tr>`; }
function rowTrainer(t){ return `<tr data-id="${t.id}"><td>${input('naam',t.naam)}</td><td>${input('functie',t.functie||'')}</td><td class="actions-cell">${iconBtns('trainers',t.id)}</td></tr>`; }
function mountCRUD(){ const db=SHDB.loadDB(); document.getElementById('tbl-namen').innerHTML=(db.namen||[]).map(rowNamen).join(''); document.getElementById('tbl-types').innerHTML=(db.types||[]).map(rowTypes).join(''); document.getElementById('tbl-locaties').innerHTML=(db.locaties||[]).map(rowLoc).join(''); document.getElementById('tbl-themas').innerHTML=(db.themas||[]).map(rowThema).join(''); document.getElementById('tbl-trainers').innerHTML=(db.trainers||[]).map(rowTrainer).join(''); document.getElementById('add-naam').onclick=()=>{const d=SHDB.loadDB();d.namen.push({id:SHDB.uid('nm'),naam:'Nieuwe naam',lesduur:60,prijs:0,strippen:0,max:0,mailblue:'',geldigheid:0});SHDB.saveDB(d);mountCRUD();renderBeheer();}; document.getElementById('add-type').onclick=()=>{const d=SHDB.loadDB();d.types.push({id:SHDB.uid('tp'),type:'Nieuw'});SHDB.saveDB(d);mountCRUD();renderBeheer();}; document.getElementById('add-loc').onclick=()=>{const d=SHDB.loadDB();d.locaties.push({id:SHDB.uid('loc'),naam:'Nieuwe locatie',adres:'',plaats:'',land:'BE'});SHDB.saveDB(d);mountCRUD();renderBeheer();}; document.getElementById('add-th').onclick=()=>{const d=SHDB.loadDB();d.themas.push({id:SHDB.uid('th'),naam:'Nieuw thema'});SHDB.saveDB(d);mountCRUD();renderBeheer();}; document.getElementById('add-tr').onclick=()=>{const d=SHDB.loadDB();d.trainers.push({id:SHDB.uid('tr'),naam:'Nieuwe trainer',functie:''});SHDB.saveDB(d);mountCRUD();renderBeheer();}; document.body.addEventListener('click',(e)=>{ const btn=e.target.closest('button.iconbtn'); if(!btn) return; const key=btn.dataset.key, id=btn.dataset.id, act=btn.dataset.act; const d=SHDB.loadDB(); if(act==='del'){ if(confirm('Verwijderen?')){ d[key]=d[key].filter(x=>x.id!==id); SHDB.saveDB(d); mountCRUD(); renderBeheer(); } return; } if(act==='save'){ const tr=btn.closest('tr'); const obj={}; tr.querySelectorAll('input').forEach(i=>obj[i.name]=i.value); const i=d[key].findIndex(x=>x.id===id); if(i>=0){ d[key][i]={...d[key][i],...obj}; } SHDB.saveDB(d); renderBeheer(); }}); } window.addEventListener('DOMContentLoaded', mountCRUD);