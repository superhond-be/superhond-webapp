
const $ = s => document.querySelector(s);
async function fetchJSON(url, opts={}){ const r = await fetch(url,{headers:{'Content-Type':'application/json'},...opts}); if(!r.ok) throw new Error('HTTP '+r.status); return r.json(); }
function rowHTML(it){ return `<tr><td>${it.id}</td><td>${it.type}</td><td>${it.theme}</td><td>${it.location}</td><td>${it.date}</td><td>${it.time}</td><td>${it.trainer}</td><td><button class='edit' data-id='${it.id}'>Wijzig</button><button class='delete' data-id='${it.id}'>Verwijder</button></td></tr>`; }
async function loadList(){ const data=await fetchJSON('/lessons'); document.querySelector('#tbl tbody').innerHTML=data.items.map(rowHTML).join(''); }
function openDialog(it){ const dlg=document.querySelector('#dlgForm'); document.querySelector('#lessonId').value=it?.id||''; document.querySelector('#type').value=it?.type||'Puppy'; document.querySelector('#theme').value=it?.theme||''; document.querySelector('#location').value=it?.location||''; document.querySelector('#date').value=it?.date||''; document.querySelector('#time').value=it?.time||''; document.querySelector('#trainer').value=it?.trainer||''; dlg.showModal(); }
async function saveForm(){ const id=document.querySelector('#lessonId').value; const body=JSON.stringify({ type:$('#type').value, theme:$('#theme').value, location:$('#location').value, date:$('#date').value, time:$('#time').value, trainer:$('#trainer').value }); if(id) await fetchJSON('/lessons/'+id,{method:'PUT',body}); else await fetchJSON('/lessons',{method:'POST',body}); document.querySelector('#dlgForm').close(); await loadList(); }
document.addEventListener('DOMContentLoaded',()=>{ loadList(); document.querySelector('#btnNew').onclick=()=>openDialog(null); document.querySelector('#btnSave').onclick=saveForm; document.querySelector('#tbl').onclick=async e=>{ if(e.target.classList.contains('edit')){ const id=e.target.dataset.id; const d=await fetchJSON('/lessons/'+id); openDialog(d.item);} if(e.target.classList.contains('delete')){ const id=e.target.dataset.id; if(confirm('Verwijderen?')){ await fetchJSON('/lessons/'+id,{method:'DELETE'}); await loadList(); } } }; });
