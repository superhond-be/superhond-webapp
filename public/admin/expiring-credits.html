<!doctype html><html lang="nl"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Bijna verlopen credits – Admin</title>
<style>
body{font-family:system-ui,sans-serif;max-width:1000px;margin:24px auto;padding:0 16px}
table{width:100%;border-collapse:collapse}
th,td{padding:8px;border-bottom:1px solid #eee;text-align:left}
.badge{padding:2px 8px;border-radius:999px;font-size:12px;color:#fff;font-weight:600;background:#f4a000}
</style>
</head><body>
<h1>⚠️ Bijna verlopen credits</h1>
<p class="muted">Overzicht van alle credits die binnen 14 dagen vervallen.</p>
<table>
  <thead><tr><th>Hond</th><th>Klant</th><th>Email</th><th>Cursus</th><th>Remaining</th><th>Geldig t/m</th><th></th></tr></thead>
  <tbody id="rows"></tbody>
</table>
<script>
const $=s=>document.querySelector(s);
async function load(){
  const r=await fetch('/api/public-enrollments/expiring-credits',{credentials:'include'});
  const data=await r.json();
  const rows=$('#rows'); rows.innerHTML='';
  (data.expiring||[]).forEach(c=>{
    const date = new Date(c.valid_until).toLocaleDateString();
    rows.insertAdjacentHTML('beforeend',`
      <tr>
        <td>${c.dog}</td>
        <td>${c.klant}</td>
        <td>${c.email}</td>
        <td>${c.course_id}</td>
        <td>${c.remaining}</td>
        <td><span class="badge">${date} (⏳ ${c.daysLeft} dagen)</span></td>
        <td><button onclick="alert('Contacteer ${c.klant} via ${c.email}')">Contact</button></td>
      </tr>`);
  });
}
load();
</script>
</body></html>
