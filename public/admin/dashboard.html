<!doctype html><html lang="nl"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Superhond ‚Äî Admin Dashboard</title>
<style>
:root{ --border:#ddd; --muted:#666; }
body{font-family:system-ui,Segoe UI,Arial,sans-serif;max-width:1100px;margin:24px auto;padding:0 16px;background:#fafafa;color:#222}
h1{margin:0 0 8px}
.sub{color:var(--muted);margin:0 0 16px}
.row{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:14px}
.card{background:#fff;border:1px solid var(--border);border-radius:10px;padding:14px}
.muted{color:var(--muted)}
a.btn,button.btn{display:inline-block;padding:9px 12px;border:1px solid #ccc;border-radius:8px;text-decoration:none;color:#111;background:#fff;cursor:pointer}
a.btn:hover,button.btn:hover{background:#f5f5f5}
.bigLink{font-size:16px}
#notifWrap{display:flex;align-items:flex-start;gap:12px}
#notifBell{position:relative;cursor:pointer;display:inline-block;font-size:24px;line-height:24px}
#notifCount{position:absolute;top:-6px;right:-6px;background:#d32f2f;color:#fff;font-size:12px;padding:2px 6px;border-radius:999px;display:none}
#expCount{position:absolute;top:14px;right:-6px;background:#f4a000;color:#000;font-size:12px;padding:2px 6px;border-radius:999px;display:none}
.legend{margin-top:8px;font-size:13px;color:#555}
.dot{display:inline-block;width:14px;height:14px;border-radius:50%;margin-right:6px;vertical-align:-2px}
.dot.red{background:#d32f2f}.dot.orange{background:#f4a000}
.stack{display:flex;flex-direction:column;gap:8px}
</style>
</head><body>
<h1>Superhond ‚Äî Admin Dashboard</h1>
<p class="sub">Welkom! Gebruik de snelkoppelingen hieronder voor je dagelijkse taken.</p>
<div class="row">
  <div class="card">
    <div id="notifWrap">
      <div id="notifBell" title="Klik bovenaan voor meldingen, onderaan voor bijna verlopen credits">üîî
        <span id="notifCount"></span>
        <span id="expCount" title="Bijna verlopen credits"></span>
      </div>
      <div>
        <div class="legend">
          <div><span class="dot red"></span> Ongelezen meldingen</div>
          <div><span class="dot orange"></span> Bijna verlopen credits</div>
        </div>
        <a href="/admin/notificaties.html" id="notifLink" style="display:none"></a>
        <a href="/admin/expiring-credits.html" id="expLink" style="display:none"></a>
      </div>
    </div>
  </div>
  <div class="card stack">
    <div>
      <div class="muted">Overzicht</div>
      <h3 style="margin:4px 0 8px">‚ö†Ô∏è Bijna verlopen credits: <span id="expiringCreditsCount">‚Ä¶</span></h3>
      <a class="btn bigLink" href="/admin/expiring-credits.html">Open overzicht</a>
    </div>
  </div>
  <div class="card stack">
    <div>
      <div class="muted">Doelgroepen</div>
      <h3 style="margin:4px 0 8px">üéØ Doelgroepen / Segmenten</h3>
      <a class="btn bigLink" href="/admin/segments.html">Open segmenten</a>
    </div>
  </div>
</div>
<script>
(function(){
  const api=(p)=>fetch(p,{credentials:'include'});
  async function loadNotifCount(){
    try{const r=await api('/api/admin/notifications');const d=await r.json();const u=(d.items||[]).filter(n=>!n.seen_by_admin).length;const el=document.getElementById('notifCount');el.textContent=u;el.style.display=u>0?'inline-block':'none';if(u>0)el.title=u+' ongelezen melding(en)';}catch(e){}
  }
  async function loadExpCount(){
    try{const r=await api('/api/public-enrollments/expiring-credits');const d=await r.json();const c=(d.expiring||[]).length;const el=document.getElementById('expCount');el.textContent=c;el.style.display=c>0?'inline-block':'none';if(c>0)el.title='Bijna verlopen credits: '+c;}catch(e){}
  }
  async function loadExpLine(){ try{const r=await api('/api/public-enrollments/expiring-credits');const d=await r.json();document.getElementById('expiringCreditsCount').textContent=(d.expiring||[]).length;}catch(e){document.getElementById('expiringCreditsCount').textContent='?';} }
  document.getElementById('notifBell').addEventListener('click',(ev)=>{
    const box=ev.currentTarget.getBoundingClientRect();const clickY=ev.clientY-box.top;const half=box.height/2;
    if(clickY<=half) document.getElementById('notifLink').click(); else document.getElementById('expLink').click();
  });
  function refresh(){ loadNotifCount(); loadExpCount(); loadExpLine(); }
  refresh(); setInterval(refresh, 30000);
})();
</script>
</body></html>
