<!doctype html><html lang="nl"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Inschrijvingen ‚Äì Superhond</title>
<style>
body{font-family:system-ui,sans-serif;max-width:900px;margin:24px auto;padding:0 16px}
h1{margin:0 0 16px}
.card{background:#fff;border:1px solid #ddd;border-radius:8px;padding:12px;margin-bottom:16px}
label{display:block;font-size:12px;margin-top:8px}
input,select,button{width:100%;padding:8px;border:1px solid #ccc;border-radius:6px}
table{width:100%;border-collapse:collapse;margin-top:8px}
td,th{border-bottom:1px solid #eee;padding:6px;text-align:left}
</style>
</head><body>
<h1>üìã Inschrijvingen</h1>

<div class="card">
  <h3>Nieuwe inschrijving</h3>
  <form id="f">
    <label>Sessie ID<input id="sess"></label>
    <label>Klant ID<input id="klant"></label>
    <label>Hond ID<input id="hond"></label>
    <button>Aanmelden</button>
  </form>
  <div id="msg"></div>
</div>

<div class="card">
  <h3>Alle inschrijvingen</h3>
  <table><thead><tr><th>Sessie</th><th>Klant</th><th>Hond</th><th>Status</th><th></th></tr></thead>
  <tbody id="list"></tbody></table>
</div>

<script>
const api=(p,opt={})=>fetch(p,{credentials:'include',headers:{'Content-Type':'application/json'},...opt});
const $=s=>document.querySelector(s);

async function load(){
  const r=await api('/api/enrollments'); const arr=await r.json();
  const t=$('#list'); t.innerHTML='';
  arr.forEach(e=>{
    t.insertAdjacentHTML('beforeend',`
      <tr><td>${e.session_id}</td><td>${e.klant_id}</td><td>${e.hond_id}</td>
      <td>${e.status}</td>
      <td>${e.status==='actief'?'<button data-id="'+e.id+'">Annuleer</button>':''}</td></tr>`);
  });
  t.querySelectorAll('button[data-id]').forEach(b=>{
    b.onclick=async()=>{
      await api('/api/enrollments/'+b.dataset.id+'/cancel',{method:'PATCH'});
      load();
    };
  });
}

$('#f').onsubmit=async e=>{
  e.preventDefault();
  const body={ session_id:$('#sess').value, klant_id:$('#klant').value, hond_id:$('#hond').value };
  const r=await api('/api/enrollments',{method:'POST',body:JSON.stringify(body)});
  $('#msg').textContent=r.ok?'‚úîÔ∏è Ingeschreven':'‚ùå Fout';
  load();
};

load();
</script>
</body></html>
